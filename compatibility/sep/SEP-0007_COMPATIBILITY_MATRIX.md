# SEP-0007 (URI Scheme to facilitate delegated signing) Compatibility Matrix

**Generated:** 2025-10-10

**SEP Version:** 2.1.0
**SEP Status:** Active
**SEP URL:** https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0007.md

## SEP Summary

This Stellar Ecosystem Proposal introduces a URI Scheme that can be used to generate a URI that will serve as a request to sign a transaction.

The URI (request) will typically be signed by the user‚Äôs trusted wallet where she stores her secret key(s).

Proposal for a URI Scheme that can be used to generate standardized URIs that will represent a request to sign a specific transaction on the Stellar Network.

These URIs will be generated by applications that do not hold secret keys and need to delegate signing to a third-party system that is trusted by the user.

These URIs can be interpreted by any application or wallet that complies with this SEP.

The signing applications (wallets) should follow the [recommended security best practices](#security-best-practices-for-compliance-with-this-sep) i.

## Overall Coverage

**Total Coverage:** 100.0% (31/31 fields)

- ‚úÖ **Implemented:** 31/31
- ‚ùå **Not Implemented:** 0/31

**Required Fields:** 100.0% (18/18)

**Optional Fields:** 100.0% (13/13)

## Implementation Status

‚úÖ **Implemented**

### Implementation Files

- `stellarsdk/stellarsdk/uri_scheme/URIScheme.swift`
- `stellarsdk/stellarsdk/uri_scheme/validator/URISchemeValidator.swift`
- `stellarsdk/stellarsdk/uri_scheme/enums/URISchemeEnums.swift`
- `stellarsdk/stellarsdk/uri_scheme/errors/URISchemeErrors.swift`

### Key Classes

- **`URIScheme`**: Main class for generating SEP-07 URIs for tx and pay operations
- **`URISchemeValidator`**: Validator class for signing and verifying SEP-07 URIs
- **`SignTransactionParams`**: Enum defining all TX operation parameters (xdr, replace, callback, pubkey, chain, msg, network_passphrase, origin_domain, signature)
- **`PayOperationParams`**: Enum defining all PAY operation parameters (destination, amount, asset_code, asset_issuer, memo, memo_type, callback, msg, network_passphrase, origin_domain, signature)
- **`URISchemeErrors`**: Error enum for URI validation failures (invalidSignature, invalidOriginDomain, missingOriginDomain, missingSignature, invalidTomlDomain, invalidToml, tomlSignatureMissing)
- **`SignURLEnum`**: Result enum for URI signing operations (success with signed URL, or failure)
- **`URISchemeIsValidEnum`**: Result enum for URI validation operations (success or failure with error)
- **`SetupTransactionXDREnum`**: Result enum for transaction setup (success with XDR or failure)
- **`SubmitTransactionEnum`**: Result enum for transaction submission (success, destinationRequiresMemo, or failure)

## Coverage by Section

| Section | Coverage | Required Coverage | Implemented | Total |
|---------|----------|-------------------|-------------|-------|
| URI Operations | 100.0% | 100.0% | 2 | 2 |
| TX Operation Parameters | 100.0% | 100.0% | 5 | 5 |
| PAY Operation Parameters | 100.0% | 100.0% | 6 | 6 |
| Common Parameters | 100.0% | 100.0% | 4 | 4 |
| Validation Features | 100.0% | 100.0% | 11 | 11 |
| Signature Features | 100.0% | 100.0% | 3 | 3 |

## Detailed Field Comparison

### URI Operations

| Field | Required | Status | SDK Property | Description |
|-------|----------|--------|--------------|-------------|
| `tx` | ‚úì | ‚úÖ | `getSignTransactionURI(transactionXDR:...)` | Transaction operation - Request to sign a transaction |
| `pay` | ‚úì | ‚úÖ | `getPayOperationURI(destination:...)` | Payment operation - Request to pay a specific address |

### TX Operation Parameters

| Field | Required | Status | SDK Property | Description |
|-------|----------|--------|--------------|-------------|
| `xdr` | ‚úì | ‚úÖ | `SignTransactionParams.xdr` | Base64 encoded TransactionEnvelope XDR |
| `replace` |  | ‚úÖ | `SignTransactionParams.replace` | URL-encoded field replacement using Txrep (SEP-0011) format |
| `callback` |  | ‚úÖ | `SignTransactionParams.callback` | URL for transaction submission callback |
| `pubkey` |  | ‚úÖ | `SignTransactionParams.pubkey` | Stellar public key to specify which key should sign |
| `chain` |  | ‚úÖ | `SignTransactionParams.chain` | Nested SEP-0007 URL for transaction chaining |

### PAY Operation Parameters

| Field | Required | Status | SDK Property | Description |
|-------|----------|--------|--------------|-------------|
| `destination` | ‚úì | ‚úÖ | `PayOperationParams.destination` | Stellar account ID or payment address to receive payment |
| `amount` |  | ‚úÖ | `PayOperationParams.amount` | Amount to send |
| `asset_code` |  | ‚úÖ | `PayOperationParams.asset_code` | Asset code for the payment (e.g., USD, BTC) |
| `asset_issuer` |  | ‚úÖ | `PayOperationParams.asset_issuer` | Stellar account ID of asset issuer |
| `memo` |  | ‚úÖ | `PayOperationParams.memo` | Memo value to attach to transaction |
| `memo_type` |  | ‚úÖ | `memoType parameter in getPayOperationURI` | Type of memo (MEMO_TEXT, MEMO_ID, MEMO_HASH, MEMO_RETURN) |

### Common Parameters

| Field | Required | Status | SDK Property | Description |
|-------|----------|--------|--------------|-------------|
| `msg` |  | ‚úÖ | `SignTransactionParams.msg / PayOperationParams.msg` | Message for the user (max 300 characters) |
| `network_passphrase` |  | ‚úÖ | `SignTransactionParams.network_passphrase / PayOperationParams.network_passphrase` | Network passphrase for the transaction |
| `origin_domain` |  | ‚úÖ | `SignTransactionParams.origin_domain / PayOperationParams.origin_domain` | Fully qualified domain name of the service originating the request |
| `signature` |  | ‚úÖ | `SignTransactionParams.signature / PayOperationParams.signature` | Signature of the URL for verification |

### Validation Features

| Field | Required | Status | SDK Property | Description |
|-------|----------|--------|--------------|-------------|
| `validate_uri_scheme` | ‚úì | ‚úÖ | `URISchemeName constant ("web+stellar:")` | Validate that URI starts with web+stellar: |
| `validate_operation_type` | ‚úì | ‚úÖ | `SignOperation ("tx?") / PayOperation ("pay?") constants` | Validate operation type is tx or pay |
| `validate_xdr_parameter` | ‚úì | ‚úÖ | `TransactionXDR parameter validation in getSignTransactionURI` | Validate XDR parameter for tx operation |
| `validate_destination_parameter` | ‚úì | ‚úÖ | `destination parameter requirement in getPayOperationURI` | Validate destination parameter for pay operation |
| `validate_stellar_address` | ‚úì | ‚úÖ | `PublicKey(accountId:) validation` | Validate Stellar addresses (account IDs, muxed accounts, contract IDs) |
| `validate_asset_code` | ‚úì | ‚úÖ | `assetCode parameter in getPayOperationURI` | Validate asset code length and format |
| `validate_memo_type` | ‚úì | ‚úÖ | `MemoTypeAsString enum validation in switch statement` | Validate memo type is one of allowed types |
| `validate_memo_value` | ‚úì | ‚úÖ | `Type-specific memo encoding in getPayOperationURI` | Validate memo value based on memo type |
| `validate_message_length` | ‚úì | ‚úÖ | `MessageMaximumLength constant (300) with count check` | Validate message parameter length (max 300 chars) |
| `validate_origin_domain` | ‚úì | ‚úÖ | `isFullyQualifiedDomainName validation in URISchemeValidator` | Validate origin_domain is fully qualified domain name |
| `validate_chain_nesting` | ‚úì | ‚úÖ | `chain parameter with URL encoding` | Validate chain parameter nesting depth (max 7 levels) |

### Signature Features

| Field | Required | Status | SDK Property | Description |
|-------|----------|--------|--------------|-------------|
| `sign_uri` | ‚úì | ‚úÖ | `signURI(url:signerKeyPair:)` | Sign a SEP-0007 URI with a keypair |
| `verify_signature` | ‚úì | ‚úÖ | `verify(forURL:urlEncodedBase64Signature:signerPublicKey:)` | Verify URI signature with a public key |
| `verify_signed_uri` | ‚úì | ‚úÖ | `checkURISchemeIsValid(url:)` | Verify signed URI by fetching signing key from origin domain TOML |

## Implementation Gaps

üéâ **No gaps found!** All fields are implemented.

## Recommendations

‚úÖ The SDK has excellent compatibility with SEP-07!
- Use getSignTransactionURI() to create transaction signing requests
- Use getPayOperationURI() to create payment requests
- Always validate URIs before processing using URISchemeValidator
- Sign URIs with signURI() when you are the request originator
- Verify signed URIs with checkURISchemeIsValid() when you are the receiver
- Include origin_domain and signature for trusted URI requests
- Keep messages under 300 characters (enforced by MessageMaximumLength)
- Use callback parameter to receive signed transaction envelopes
- Specify network_passphrase for non-public networks
- Use pubkey parameter to specify which key should sign
- Chain multiple operations using the chain parameter
- Implement replace parameter for dynamic transaction field replacement (SEP-11)
- For payments, specify amount, asset_code, and asset_issuer for non-XLM assets
- Use appropriate memo_type (MEMO_TEXT, MEMO_ID, MEMO_HASH, MEMO_RETURN)
- Validate destination addresses before creating payment URIs
- Test URIs with both web+stellar: scheme and proper URL encoding
- Verify origin domain TOML files contain URI_REQUEST_SIGNING_KEY
- Handle URISchemeErrors enum for proper error messages
- Use signAndSubmitTransaction() for complete signing and submission workflow

## Legend

- ‚úÖ **Implemented**: Field is implemented in SDK
- ‚ùå **Not Implemented**: Field is missing from SDK
- ‚úì **Required**: Field is required by SEP specification
- (blank) **Optional**: Field is optional

---

**Report Generated:** 2025-10-10
**SDK Version:** 3.2.6
**Analysis Tool:** SEP Compatibility Matrix Generator v2.0